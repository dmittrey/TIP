# Напишите вариант программы, для которой анализ открытости-закрытости файлов не показывает корректный результат даже с учётом всех возможных условий в переходах

Чтобы испортить результаты анализа, достаточно добавить в исходную программу к переменной `flag` зависимость от переменной `x`
****
Add commentMore actions
```
if (x > 15) {
  open();
  flag = 1;
  // Здесь всё как обычно
} else {
  close();
  if (x == 5) {
    flag = 0;
  } else { 
    flag = 1;
  }
}

// (flag = 0) -> {close}, а про flag = 1 информации нет
if (flag) {
  close();
}
```

##### Предложите, каким образом можно решить описанные в лекции проблемы в этой ситуации
Исправить текущий анализ можно, добавив в анализ к `flag` зависимость по `x`. То есть, к правилам

```
[[assume(flag == 1)]] = JOIN(n)[(flag == 0) -> {}]
[[assume(flag == 0)]] = JOIN(n)[(flag == 1) -> {}]
[[flag = 1]] = JOIN(n)[(flag == 0) -> {}]
[[flag = 0]] = JOIN(n)[(flag == 1) -> {}]
```

добавить следующие:

```
[[if (x == 5)]] = JOIN(n)[flag = 0]
[[if (cond(x)]] = JOIN(n)[flag = 1] // Любое другое условие на x
```

Тогда анализ найдёт потенциальную ошибку:

```
if (x > 15) {
  open();
  flag = 1;
  // (!(x == 5)) -> (flag = 1) -> {open}
} else {
  close();
  if (x == 5) {
    flag = 0; // (x == 5) -> (flag = 0) -> {closed}
  } else { 
    flag = 1; // (!(x == 5)) -> (flag = 1) -> {closed}
  }
}

// (!(x == 5)) -> (flag = 1) -> {open}
// (x == 5) -> (flag = 0) -> {closed}
// (!(x == 5)) -> (flag = 1) -> {closed}
if (flag) {
  close(); // В этой точке можем корректно порепортить ошибку
}
```